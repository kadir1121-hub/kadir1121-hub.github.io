<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<title>ðŸš— PixelCar ðŸš—</title>
<style>
  /* Temel stil ayarlarÄ± */
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    background-color: #323232;
    color: white;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    user-select: none;
    overflow: hidden;
    text-align: center;
  }
  #title {
    font-size: 40px;
    font-weight: bold;
    padding: 15px 0;
    user-select: none;
  }
  #gameCanvas {
    background-color: #323232;
    border: 3px solid #555;
    display: block;
    margin: 0 auto 10px auto;
    touch-action: none;
  }
  #controls {
    position: fixed;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    width: 280px;
    height: 100px;
    display: flex;
    justify-content: space-around;
    align-items: center;
    user-select: none;
    z-index: 10;
  }
  .btn {
    background-color: #555;
    border-radius: 12px;
    width: 65px;
    height: 65px;
    color: white;
    font-size: 42px;
    line-height: 65px;
    text-align: center;
    user-select: none;
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;
    transition: background-color 0.15s ease;
  }
  .btn:active {
    background-color: #999;
  }
</style>
</head>
<body>

<div id="title">ðŸš— PixelCar ðŸš—</div>

<canvas id="gameCanvas" width="800" height="600"></canvas>

<div id="controls">
  <div id="leftBtn" class="btn">â—€</div>
  <div id="upBtn" class="btn">â–²</div>
  <div id="downBtn" class="btn">â–¼</div>
  <div id="rightBtn" class="btn">â–¶</div>
</div>

<script>
(() => {
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');

  const WIDTH = canvas.width;
  const HEIGHT = canvas.height;

  // Renkler
  const GRAY = 'rgb(50,50,50)';
  const YELLOW = 'rgb(255,255,0)';
  const RED = 'rgb(200,0,0)';
  const BLUE = 'rgb(0,0,255)';

  // Oyuncu arabasÄ±
  const carWidth = 40;
  const carHeight = 70;
  let carX = WIDTH / 2 - carWidth / 2;
  let carY = HEIGHT - carHeight - 20;
  const carSpeed = 5;

  // DÃ¼ÅŸman arabalar
  const enemyWidth = 40;
  const enemyHeight = 70;
  const enemySpeed = 5;
  const enemyCount = 5;
  const enemyCars = [];

  function createEnemy() {
    const x = Math.floor(Math.random() * (WIDTH - 200)) + 100;
    const y = Math.floor(Math.random() * -600) - enemyHeight;
    return { x, y, width: enemyWidth, height: enemyHeight };
  }

  for (let i = 0; i < enemyCount; i++) {
    enemyCars.push(createEnemy());
  }

  // TuÅŸ durumu
  const keys = {
    left: false,
    right: false,
    up: false,
    down: false,
  };

  // Dokunmatik butonlar
  const leftBtn = document.getElementById('leftBtn');
  const rightBtn = document.getElementById('rightBtn');
  const upBtn = document.getElementById('upBtn');
  const downBtn = document.getElementById('downBtn');

  function addTouchListeners(btn, keyName) {
    btn.addEventListener('touchstart', e => {
      e.preventDefault();
      keys[keyName] = true;
    }, { passive: false });
    btn.addEventListener('touchend', e => {
      e.preventDefault();
      keys[keyName] = false;
    }, { passive: false });
    btn.addEventListener('touchcancel', e => {
      e.preventDefault();
      keys[keyName] = false;
    }, { passive: false });
  }

  addTouchListeners(leftBtn, 'left');
  addTouchListeners(rightBtn, 'right');
  addTouchListeners(upBtn, 'up');
  addTouchListeners(downBtn, 'down');

  // Klavye dinleyicileri
  window.addEventListener('keydown', e => {
    switch (e.key) {
      case 'ArrowLeft': keys.left = true; break;
      case 'ArrowRight': keys.right = true; break;
      case 'ArrowUp': keys.up = true; break;
      case 'ArrowDown': keys.down = true; break;
    }
  });
  window.addEventListener('keyup', e => {
    switch (e.key) {
      case 'ArrowLeft': keys.left = false; break;
      case 'ArrowRight': keys.right = false; break;
      case 'ArrowUp': keys.up = false; break;
      case 'ArrowDown': keys.down = false; break;
    }
  });

  // Yol Ã§izgisi Ã§izimi
  function drawRoad() {
    ctx.fillStyle = GRAY;
    ctx.fillRect(0, 0, WIDTH, HEIGHT);
    ctx.fillStyle = YELLOW;
    for (let i = 0; i < HEIGHT; i += 40) {
      ctx.fillRect(WIDTH / 2 - 5, i, 10, 20);
    }
  }

  // Araba Ã§izimi
  function drawCar(x, y) {
    ctx.fillStyle = RED;
    ctx.fillRect(x, y, carWidth, carHeight);
  }

  // DÃ¼ÅŸman arabalarÄ± Ã§izimi
  function drawEnemies() {
    ctx.fillStyle = BLUE;
    enemyCars.forEach(enemy => {
      ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
    });
  }

  // DÃ¼ÅŸmanlarÄ± hareket ettir
  function moveEnemies() {
    enemyCars.forEach(enemy => {
      enemy.y += enemySpeed;
      if (enemy.y > HEIGHT) {
        enemy.x = Math.floor(Math.random() * (WIDTH - 200)) + 100;
        enemy.y = Math.floor(Math.random() * -600) - enemyHeight;
      }
    });
  }

  // Ã‡arpÄ±ÅŸma kontrolÃ¼
  function checkCollision(rect1, rect2) {
    return !(
      rect1.x > rect2.x + rect2.width ||
      rect1.x + rect1.width < rect2.x ||
      rect1.y > rect2.y + rect2.height ||
      rect1.y + rect1.height < rect2.y
    );
  }

  function checkAnyCollision(playerRect) {
    for (let enemy of enemyCars) {
      if (checkCollision(playerRect, enemy)) {
        return true;
      }
    }
    return false;
  }

  // Oyun dÃ¶ngÃ¼sÃ¼
  function gameLoop() {
    // Araba hareketi
    if (keys.left && carX > 0) carX -= carSpeed;
    if (keys.right && carX < WIDTH - carWidth) carX += carSpeed;
    if (keys.up && carY > 0) carY -= carSpeed;
    if (keys.down && carY < HEIGHT - carHeight) carY += carSpeed;

    // DÃ¼ÅŸman hareketi
    moveEnemies();

    // Ã‡arpÄ±ÅŸma kontrolÃ¼
    const playerRect = { x: carX, y: carY, width: carWidth, height: carHeight };
    if (checkAnyCollision(playerRect)) {
      alert('ðŸ’¥ Ã‡arpÄ±ÅŸma! Oyun Bitti.');
      window.location.reload();
      return;
    }

    // Ã‡izim
    drawRoad();
    drawCar(carX, carY);
    drawEnemies();

    requestAnimationFrame(gameLoop);
  }

  gameLoop();
})();
</script>

</body>
</html>
